{"ast":null,"code":"import _classCallCheck from\"/home/pkorytar/Projects/RedHat/pnc-web-ui-react/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/home/pkorytar/Projects/RedHat/pnc-web-ui-react/node_modules/@babel/runtime/helpers/esm/createClass.js\";import axios from'axios';import*as WebConfigAPI from'./WebConfigService';import{keycloakService}from'./keycloakService';/**\n * Utils class managing http client instance, only one instance is created.\n */var PncClient=/*#__PURE__*/function(){// development and testing purposes\nfunction PncClient(){_classCallCheck(this,PncClient);this.httpClient=void 0;this.mathRandom=Math.random();this.createHttpClient=function(){var httpClient=axios.create({baseURL:WebConfigAPI.getPncUrl()});httpClient.interceptors.request.use(function(config){var _config$params;// perform actions before request is sent\nif(keycloakService.isAuthenticated()){var _config$headers;config.headers=(_config$headers=config.headers)!==null&&_config$headers!==void 0?_config$headers:{};config.headers.Authorization=\"Bearer \"+keycloakService.getToken();}/*\n       * Convert pageIndex to zero based to be compatible with Orch API\n       *  - Orch API first page index value is 0\n       *  - UI first page index value is 1\n       */if((_config$params=config.params)!==null&&_config$params!==void 0&&_config$params.pageIndex){var pageIndex=config.params.pageIndex;if(Number.isInteger(+pageIndex)){config.params.pageIndex=Number(pageIndex)-1;}else{throw new Error(\"Invalid pageIndex: \".concat(pageIndex,\", canceling HTTP request\"));}}return config;});return httpClient;};this.httpClient=this.createHttpClient();}/**\n   * Creates Axios instance and configure interceptors.\n   *\n   * @returns Axios instance\n   */_createClass(PncClient,[{key:\"getHttpClient\",value:// PUBLIC\n/**\n   * @returns Axios instance\n   */function getHttpClient(){return this.httpClient;}}]);return PncClient;}();export var pncClient=new PncClient();","map":{"version":3,"names":["axios","WebConfigAPI","keycloakService","PncClient","httpClient","mathRandom","Math","random","createHttpClient","create","baseURL","getPncUrl","interceptors","request","use","config","isAuthenticated","headers","Authorization","getToken","params","pageIndex","Number","isInteger","Error","pncClient"],"sources":["/home/pkorytar/Projects/RedHat/pnc-web-ui-react/src/services/pncClient.ts"],"sourcesContent":["import axios, { AxiosInstance } from 'axios';\nimport * as WebConfigAPI from './WebConfigService';\nimport { keycloakService } from './keycloakService';\n\n/**\n * Utils class managing http client instance, only one instance is created.\n */\nclass PncClient {\n  private httpClient: AxiosInstance;\n  public mathRandom: number = Math.random(); // development and testing purposes\n\n  constructor() {\n    this.httpClient = this.createHttpClient();\n  }\n\n  /**\n   * Creates Axios instance and configure interceptors.\n   *\n   * @returns Axios instance\n   */\n  private createHttpClient = (): AxiosInstance => {\n    const httpClient = axios.create({\n      baseURL: WebConfigAPI.getPncUrl(),\n    });\n\n    httpClient.interceptors.request.use((config) => {\n      // perform actions before request is sent\n\n      if (keycloakService.isAuthenticated()) {\n        config.headers = config.headers ?? {};\n        config.headers.Authorization = `Bearer ` + keycloakService.getToken();\n      }\n\n      /*\n       * Convert pageIndex to zero based to be compatible with Orch API\n       *  - Orch API first page index value is 0\n       *  - UI first page index value is 1\n       */\n      if (config.params?.pageIndex) {\n        const pageIndex = config.params.pageIndex;\n        if (Number.isInteger(+pageIndex)) {\n          config.params.pageIndex = Number(pageIndex) - 1;\n        } else {\n          throw new Error(`Invalid pageIndex: ${pageIndex}, canceling HTTP request`);\n        }\n      }\n\n      return config;\n    });\n    return httpClient;\n  };\n\n  // PUBLIC\n\n  /**\n   * @returns Axios instance\n   */\n  public getHttpClient(): AxiosInstance {\n    return this.httpClient;\n  }\n}\n\nexport const pncClient = new PncClient();\n"],"mappings":"wQAAA,MAAOA,MAAP,KAAqC,OAArC,CACA,MAAO,GAAKC,aAAZ,KAA8B,oBAA9B,CACA,OAASC,eAAT,KAAgC,mBAAhC,CAEA;AACA;AACA,G,GACMC,U,yBAEuC;AAE3C,oBAAc,sCAHNC,UAGM,aAFPC,UAEO,CAFcC,IAAI,CAACC,MAAL,EAEd,MASNC,gBATM,CASa,UAAqB,CAC9C,GAAMJ,WAAU,CAAGJ,KAAK,CAACS,MAAN,CAAa,CAC9BC,OAAO,CAAET,YAAY,CAACU,SAAb,EADqB,CAAb,CAAnB,CAIAP,UAAU,CAACQ,YAAX,CAAwBC,OAAxB,CAAgCC,GAAhC,CAAoC,SAACC,MAAD,CAAY,oBAC9C;AAEA,GAAIb,eAAe,CAACc,eAAhB,EAAJ,CAAuC,qBACrCD,MAAM,CAACE,OAAP,kBAAiBF,MAAM,CAACE,OAAxB,mDAAmC,EAAnC,CACAF,MAAM,CAACE,OAAP,CAAeC,aAAf,CAA+B,UAAYhB,eAAe,CAACiB,QAAhB,EAA3C,CACD,CAED;AACN;AACA;AACA;AACA,SACM,mBAAIJ,MAAM,CAACK,MAAX,mCAAI,eAAeC,SAAnB,CAA8B,CAC5B,GAAMA,UAAS,CAAGN,MAAM,CAACK,MAAP,CAAcC,SAAhC,CACA,GAAIC,MAAM,CAACC,SAAP,CAAiB,CAACF,SAAlB,CAAJ,CAAkC,CAChCN,MAAM,CAACK,MAAP,CAAcC,SAAd,CAA0BC,MAAM,CAACD,SAAD,CAAN,CAAoB,CAA9C,CACD,CAFD,IAEO,CACL,KAAM,IAAIG,MAAJ,8BAAgCH,SAAhC,6BAAN,CACD,CACF,CAED,MAAON,OAAP,CACD,CAvBD,EAwBA,MAAOX,WAAP,CACD,CAvCa,CACZ,KAAKA,UAAL,CAAkB,KAAKI,gBAAL,EAAlB,CACD,CAED;AACF;AACA;AACA;AACA,K,mDAiCE;AAEA;AACF;AACA,KACE,wBAAsC,CACpC,MAAO,MAAKJ,UAAZ,CACD,C,yBAGH,MAAO,IAAMqB,UAAS,CAAG,GAAItB,UAAJ,EAAlB"},"metadata":{},"sourceType":"module"}