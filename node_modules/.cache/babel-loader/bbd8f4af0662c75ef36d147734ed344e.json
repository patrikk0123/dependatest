{"ast":null,"code":"import { useEffect, useState } from 'react';\n\n/**\n * Hook to manage input values, validation and states of a form. All validation is done on change of input.\n * See also {@link ProjectCreateEditPage}\n *\n * @param initValues - Values to initialize inputs with\n * @param validators - Functions to validate inputs with\n * @param callback - Function to call when submitting user input data\n *\n * Both initValues and validators are objects whose keys are equal to ids of input elements.\n */\nexport const useForm = (initValues, validators, callback) => {\n  // is submit button disabled?\n  const [isSubmitDisabled, setIsSubmitDisabled] = useState(true); // input values\n\n  const [fieldValues, setFieldValues] = useState(initValues); // input error messages\n\n  const [fieldErrors, setFieldErrors] = useState({}); // inpur validation functons\n\n  const [fieldValidators, setFieldValidators] = useState(validators);\n  const initFieldStates = { ...initValues\n  };\n  Object.keys(initFieldStates).forEach(key => {\n    initFieldStates[key] = 'default';\n  }); // input states - 'default' | 'success' | 'error'\n\n  const [fieldStates, setFieldStates] = useState(initFieldStates);\n  useEffect(() => {\n    if (isFormValid() && areRequiredFilled()) {\n      setIsSubmitDisabled(false);\n    } else {\n      setIsSubmitDisabled(true);\n    }\n  }, [fieldValues]);\n\n  const isFormValid = () => {\n    return !Object.keys(fieldErrors).length;\n  };\n\n  const areRequiredFilled = () => {\n    let areFilled = true;\n\n    for (const key in fieldValidators) {\n      if (fieldValidators[key].isRequired && !fieldValues[key]) {\n        areFilled = false;\n      }\n    }\n\n    return areFilled;\n  };\n\n  const onChange = event => {\n    const fieldName = event.currentTarget.name;\n    const fieldValue = event.currentTarget.value;\n    setFieldValues({ ...fieldValues,\n      [fieldName]: fieldValue\n    });\n    validate(fieldName, fieldValue);\n  };\n\n  const validate = (fieldName, fieldValue) => {\n    if (fieldValidators[fieldName]) {\n      const validator = fieldValidators[fieldName].validator;\n      const isRequired = fieldValidators[fieldName].isRequired;\n\n      if (isRequired) {\n        const error = fieldValue ? '' : 'Field is required';\n        setError(fieldName, fieldValue, error);\n      } else if (validator) {\n        const error = validator(fieldValue);\n        setError(fieldName, fieldValue, error);\n      }\n    }\n  };\n\n  const setError = (fieldName, fieldValue, error) => {\n    if (error) {\n      setFieldErrors({ ...fieldErrors,\n        [fieldName]: error\n      });\n      setFieldStates({ ...fieldStates,\n        [fieldName]: 'error'\n      });\n    } else {\n      const newErrors = { ...fieldErrors\n      };\n      delete newErrors[fieldName];\n      setFieldErrors(newErrors);\n\n      if (fieldValue) {\n        setFieldStates({ ...fieldStates,\n          [fieldName]: 'success'\n        });\n      } else {\n        setFieldStates({ ...fieldStates,\n          [fieldName]: 'default'\n        });\n      }\n    }\n  };\n\n  const onSubmit = () => {\n    callback(fieldValues); // reset state to 'default' (valid inputs wont be highlighted)\n\n    setFieldStates(initFieldStates);\n    setIsSubmitDisabled(true);\n  };\n\n  return {\n    fieldValues,\n    fieldErrors,\n    fieldStates,\n    isSubmitDisabled,\n    onChange,\n    setFieldValues,\n    onSubmit\n  };\n};","map":{"version":3,"names":["useEffect","useState","useForm","initValues","validators","callback","isSubmitDisabled","setIsSubmitDisabled","fieldValues","setFieldValues","fieldErrors","setFieldErrors","fieldValidators","setFieldValidators","initFieldStates","Object","keys","forEach","key","fieldStates","setFieldStates","isFormValid","areRequiredFilled","length","areFilled","isRequired","onChange","event","fieldName","currentTarget","name","fieldValue","value","validate","validator","error","setError","newErrors","onSubmit"],"sources":["/home/pkorytar/Projects/RedHat/pnc-web-ui-react/src/containers/useForm.ts"],"sourcesContent":["import { useEffect, useState } from 'react';\n\ninterface IFieldValues {\n  [key: string]: string;\n}\n\ninterface IFieldErrors {\n  [key: string]: string | undefined;\n}\n\ninterface IFieldValidators {\n  [key: string]: IValidator;\n}\n\ninterface IValidator {\n  isRequired?: boolean;\n  validator?: Function;\n}\n\n/**\n * Hook to manage input values, validation and states of a form. All validation is done on change of input.\n * See also {@link ProjectCreateEditPage}\n *\n * @param initValues - Values to initialize inputs with\n * @param validators - Functions to validate inputs with\n * @param callback - Function to call when submitting user input data\n *\n * Both initValues and validators are objects whose keys are equal to ids of input elements.\n */\nexport const useForm = (initValues: IFieldValues, validators: IFieldValidators, callback: Function) => {\n  // is submit button disabled?\n  const [isSubmitDisabled, setIsSubmitDisabled] = useState<boolean>(true);\n\n  // input values\n  const [fieldValues, setFieldValues] = useState<IFieldValues>(initValues);\n  // input error messages\n  const [fieldErrors, setFieldErrors] = useState<IFieldErrors>({});\n  // inpur validation functons\n  const [fieldValidators, setFieldValidators] = useState<IFieldValidators>(validators);\n\n  const initFieldStates = { ...initValues };\n  Object.keys(initFieldStates).forEach((key) => {\n    initFieldStates[key] = 'default';\n  });\n  // input states - 'default' | 'success' | 'error'\n  const [fieldStates, setFieldStates] = useState<any>(initFieldStates);\n\n  useEffect(() => {\n    if (isFormValid() && areRequiredFilled()) {\n      setIsSubmitDisabled(false);\n    } else {\n      setIsSubmitDisabled(true);\n    }\n  }, [fieldValues]);\n\n  const isFormValid = () => {\n    return !Object.keys(fieldErrors).length;\n  };\n\n  const areRequiredFilled = () => {\n    let areFilled = true;\n    for (const key in fieldValidators) {\n      if (fieldValidators[key].isRequired && !fieldValues[key]) {\n        areFilled = false;\n      }\n    }\n\n    return areFilled;\n  };\n\n  const onChange = (event: React.FormEvent<HTMLInputElement> | React.FormEvent<HTMLTextAreaElement>) => {\n    const fieldName = event.currentTarget.name;\n    const fieldValue = event.currentTarget.value;\n    setFieldValues({ ...fieldValues, [fieldName]: fieldValue });\n\n    validate(fieldName, fieldValue);\n  };\n\n  const validate = (fieldName: string, fieldValue: string) => {\n    if (fieldValidators[fieldName]) {\n      const validator = fieldValidators[fieldName].validator;\n      const isRequired = fieldValidators[fieldName].isRequired;\n      if (isRequired) {\n        const error = fieldValue ? '' : 'Field is required';\n        setError(fieldName, fieldValue, error);\n      } else if (validator) {\n        const error = validator(fieldValue);\n        setError(fieldName, fieldValue, error);\n      }\n    }\n  };\n\n  const setError = (fieldName: string, fieldValue: string, error: string) => {\n    if (error) {\n      setFieldErrors({ ...fieldErrors, [fieldName]: error });\n      setFieldStates({ ...fieldStates, [fieldName]: 'error' });\n    } else {\n      const newErrors = { ...fieldErrors };\n      delete newErrors[fieldName];\n      setFieldErrors(newErrors);\n      if (fieldValue) {\n        setFieldStates({ ...fieldStates, [fieldName]: 'success' });\n      } else {\n        setFieldStates({ ...fieldStates, [fieldName]: 'default' });\n      }\n    }\n  };\n\n  const onSubmit = () => {\n    callback(fieldValues);\n    // reset state to 'default' (valid inputs wont be highlighted)\n    setFieldStates(initFieldStates);\n    setIsSubmitDisabled(true);\n  };\n\n  return { fieldValues, fieldErrors, fieldStates, isSubmitDisabled, onChange, setFieldValues, onSubmit };\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}