{"ast":null,"code":"import _objectSpread from\"/home/pkorytar/Projects/RedHat/pnc-web-ui-react/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/home/pkorytar/Projects/RedHat/pnc-web-ui-react/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useCallback,useState}from'react';import{Button,Card,CardBody,Flex,FlexItem,Form,FormGroup,Grid,GridItem,Switch,TextArea,TextInput}from'@patternfly/react-core';import{PageLayout}from'./../PageLayout/PageLayout';import{useTitle}from'../../containers/useTitle';import{AttributesItems}from'../AttributesItems/AttributesItems';import{useDataContainer}from'../../containers/DataContainer/useDataContainer';import{buildService}from'../../services/buildService';import{DataContainer}from'../../containers/DataContainer/DataContainer';import{useInterval}from'../../containers/useInterval';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var REFRESH_INTERVAL_SECONDS=90;export var AdministrationPage=function AdministrationPage(){var _dataContainer$data,_dataContainer$data2,_dataContainer$data3;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isMaintenanceModeOn=_useState2[0],setIsMaintenanceModeOn=_useState2[1];var maintenanceSwitchStyle={paddingTop:'5px',paddingLeft:'8px',paddingRight:'8px',paddingBottom:'5px'};var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),secondsUntilReload=_useState4[0],setSecondsUntilReload=_useState4[1];var dataContainer=useDataContainer(useCallback(function(_ref){var requestConfig=_ref.requestConfig;return buildService.getBuildCount(requestConfig);},[]));var dataContainerRefresh=dataContainer.refresh;var refreshBuildCounts=useCallback(function(){dataContainerRefresh({});setSecondsUntilReload(REFRESH_INTERVAL_SECONDS);},[dataContainerRefresh]);var restartInterval=useInterval(useCallback(function(){setSecondsUntilReload(secondsUntilReload-1);if(secondsUntilReload<=1){refreshBuildCounts();}},[secondsUntilReload,refreshBuildCounts]),1000,true);useTitle('Administration');return/*#__PURE__*/_jsx(PageLayout,{title:\"Administration\",description:\"Administration tools for admin users\",children:/*#__PURE__*/_jsxs(Flex,{direction:{default:'column'},children:[/*#__PURE__*/_jsx(FlexItem,{children:/*#__PURE__*/_jsx(Form,{isHorizontal:true,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(CardBody,{children:/*#__PURE__*/_jsxs(Grid,{hasGutter:true,children:[/*#__PURE__*/_jsx(GridItem,{span:12,children:/*#__PURE__*/_jsx(FormGroup,{label:\"PNC System Version\",fieldId:\"form-pnc-system-version\",children:/*#__PURE__*/_jsx(TextInput,{type:\"text\",id:\"form-pnc-system-version\",name:\"form-pnc-system-version\"})})}),/*#__PURE__*/_jsx(GridItem,{span:4,children:/*#__PURE__*/_jsx(Button,{variant:\"primary\",id:\"form-pnc-system-version-update\",name:\"form-pnc-system-version-update\",children:\"Update\"})})]})})})})}),/*#__PURE__*/_jsx(FlexItem,{children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(CardBody,{children:/*#__PURE__*/_jsxs(Grid,{hasGutter:true,children:[/*#__PURE__*/_jsx(GridItem,{span:12,children:/*#__PURE__*/_jsx(DataContainer,_objectSpread(_objectSpread({},dataContainer),{},{title:\"Builds Count\",children:/*#__PURE__*/_jsx(AttributesItems,{attributes:[{name:'Running builds count',value:(_dataContainer$data=dataContainer.data)===null||_dataContainer$data===void 0?void 0:_dataContainer$data.running},{name:'Enqueued builds count',value:(_dataContainer$data2=dataContainer.data)===null||_dataContainer$data2===void 0?void 0:_dataContainer$data2.enqueued},{name:'Waiting for dependencies builds count',value:(_dataContainer$data3=dataContainer.data)===null||_dataContainer$data3===void 0?void 0:_dataContainer$data3.waitingForDependencies}]})}))}),/*#__PURE__*/_jsx(GridItem,{span:4,children:/*#__PURE__*/_jsxs(Button,{variant:\"primary\",onClick:function onClick(){refreshBuildCounts();restartInterval();},children:[\"Refresh (\",secondsUntilReload,\" s)\"]})})]})})})}),/*#__PURE__*/_jsx(FlexItem,{children:/*#__PURE__*/_jsx(Form,{isHorizontal:true,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(CardBody,{children:/*#__PURE__*/_jsxs(Grid,{hasGutter:true,children:[/*#__PURE__*/_jsx(GridItem,{span:12,children:/*#__PURE__*/_jsx(FormGroup,{label:\"Maintenance Mode\",fieldId:\"form-maintenance-mode\",children:/*#__PURE__*/_jsx(\"div\",{style:maintenanceSwitchStyle,children:/*#__PURE__*/_jsx(Switch,{id:\"form-maintenance-mode-switch\",name:\"form-maintenance-mode-switch\",label:\"Maintenance Mode On\",labelOff:\"Maintenance Mode Off\",isChecked:isMaintenanceModeOn,onChange:function onChange(){setIsMaintenanceModeOn(!isMaintenanceModeOn);}})})})}),/*#__PURE__*/_jsx(GridItem,{span:12,children:/*#__PURE__*/_jsx(FormGroup,{label:\"Announcement\",fieldId:\"form-announcement\",children:/*#__PURE__*/_jsx(TextArea,{name:\"form-announcement\",id:\"form-announcement\"})})}),/*#__PURE__*/_jsx(GridItem,{span:4,children:/*#__PURE__*/_jsx(Button,{variant:\"primary\",id:\"form-announcement-update\",name:\"form-announcement-update\",children:\"Update\"})})]})})})})})]})});};","map":{"version":3,"names":["useCallback","useState","Button","Card","CardBody","Flex","FlexItem","Form","FormGroup","Grid","GridItem","Switch","TextArea","TextInput","PageLayout","useTitle","AttributesItems","useDataContainer","buildService","DataContainer","useInterval","REFRESH_INTERVAL_SECONDS","AdministrationPage","isMaintenanceModeOn","setIsMaintenanceModeOn","maintenanceSwitchStyle","paddingTop","paddingLeft","paddingRight","paddingBottom","secondsUntilReload","setSecondsUntilReload","dataContainer","requestConfig","getBuildCount","dataContainerRefresh","refresh","refreshBuildCounts","restartInterval","default","name","value","data","running","enqueued","waitingForDependencies"],"sources":["/home/pkorytar/Projects/RedHat/pnc-web-ui-react/src/components/AdministrationPage/AdministrationPage.tsx"],"sourcesContent":["import { CSSProperties, useCallback, useState } from 'react';\nimport {\n  Button,\n  Card,\n  CardBody,\n  Flex,\n  FlexItem,\n  Form,\n  FormGroup,\n  Grid,\n  GridItem,\n  Switch,\n  TextArea,\n  TextInput,\n} from '@patternfly/react-core';\nimport { PageLayout } from './../PageLayout/PageLayout';\nimport { useTitle } from '../../containers/useTitle';\nimport { AttributesItems } from '../AttributesItems/AttributesItems';\nimport { IService, useDataContainer } from '../../containers/DataContainer/useDataContainer';\nimport { buildService } from '../../services/buildService';\nimport { DataContainer } from '../../containers/DataContainer/DataContainer';\nimport { useInterval } from '../../containers/useInterval';\n\nconst REFRESH_INTERVAL_SECONDS = 90;\n\nexport const AdministrationPage = () => {\n  const [isMaintenanceModeOn, setIsMaintenanceModeOn] = useState(false);\n  const maintenanceSwitchStyle: CSSProperties = {\n    paddingTop: '5px',\n    paddingLeft: '8px',\n    paddingRight: '8px',\n    paddingBottom: '5px',\n  };\n  const [secondsUntilReload, setSecondsUntilReload] = useState<number>(0);\n  const dataContainer = useDataContainer(\n    useCallback(({ requestConfig }: IService) => buildService.getBuildCount(requestConfig), [])\n  );\n  const dataContainerRefresh = dataContainer.refresh;\n\n  const refreshBuildCounts = useCallback(() => {\n    dataContainerRefresh({});\n    setSecondsUntilReload(REFRESH_INTERVAL_SECONDS);\n  }, [dataContainerRefresh]);\n\n  const restartInterval = useInterval(\n    useCallback(() => {\n      setSecondsUntilReload(secondsUntilReload - 1);\n      if (secondsUntilReload <= 1) {\n        refreshBuildCounts();\n      }\n    }, [secondsUntilReload, refreshBuildCounts]),\n    1000,\n    true\n  );\n\n  useTitle('Administration');\n\n  return (\n    <PageLayout title=\"Administration\" description=\"Administration tools for admin users\">\n      <Flex direction={{ default: 'column' }}>\n        <FlexItem>\n          <Form isHorizontal>\n            <Card>\n              <CardBody>\n                <Grid hasGutter>\n                  <GridItem span={12}>\n                    <FormGroup label=\"PNC System Version\" fieldId=\"form-pnc-system-version\">\n                      <TextInput type=\"text\" id=\"form-pnc-system-version\" name=\"form-pnc-system-version\" />\n                    </FormGroup>\n                  </GridItem>\n                  <GridItem span={4}>\n                    <Button variant=\"primary\" id=\"form-pnc-system-version-update\" name=\"form-pnc-system-version-update\">\n                      Update\n                    </Button>\n                  </GridItem>\n                </Grid>\n              </CardBody>\n            </Card>\n          </Form>\n        </FlexItem>\n        <FlexItem>\n          <Card>\n            <CardBody>\n              <Grid hasGutter>\n                <GridItem span={12}>\n                  <DataContainer {...dataContainer} title=\"Builds Count\">\n                    <AttributesItems\n                      attributes={[\n                        {\n                          name: 'Running builds count',\n                          value: dataContainer.data?.running,\n                        },\n                        {\n                          name: 'Enqueued builds count',\n                          value: dataContainer.data?.enqueued,\n                        },\n                        {\n                          name: 'Waiting for dependencies builds count',\n                          value: dataContainer.data?.waitingForDependencies,\n                        },\n                      ]}\n                    />\n                  </DataContainer>\n                </GridItem>\n                <GridItem span={4}>\n                  <Button\n                    variant=\"primary\"\n                    onClick={() => {\n                      refreshBuildCounts();\n                      restartInterval();\n                    }}\n                  >\n                    Refresh ({secondsUntilReload} s)\n                  </Button>\n                </GridItem>\n              </Grid>\n            </CardBody>\n          </Card>\n        </FlexItem>\n        <FlexItem>\n          <Form isHorizontal>\n            <Card>\n              <CardBody>\n                <Grid hasGutter>\n                  <GridItem span={12}>\n                    <FormGroup label=\"Maintenance Mode\" fieldId=\"form-maintenance-mode\">\n                      <div style={maintenanceSwitchStyle}>\n                        <Switch\n                          id=\"form-maintenance-mode-switch\"\n                          name=\"form-maintenance-mode-switch\"\n                          label=\"Maintenance Mode On\"\n                          labelOff=\"Maintenance Mode Off\"\n                          isChecked={isMaintenanceModeOn}\n                          onChange={() => {\n                            setIsMaintenanceModeOn(!isMaintenanceModeOn);\n                          }}\n                        />\n                      </div>\n                    </FormGroup>\n                  </GridItem>\n                  <GridItem span={12}>\n                    <FormGroup label=\"Announcement\" fieldId=\"form-announcement\">\n                      <TextArea name=\"form-announcement\" id=\"form-announcement\" />\n                    </FormGroup>\n                  </GridItem>\n                  <GridItem span={4}>\n                    <Button variant=\"primary\" id=\"form-announcement-update\" name=\"form-announcement-update\">\n                      Update\n                    </Button>\n                  </GridItem>\n                </Grid>\n              </CardBody>\n            </Card>\n          </Form>\n        </FlexItem>\n      </Flex>\n    </PageLayout>\n  );\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}