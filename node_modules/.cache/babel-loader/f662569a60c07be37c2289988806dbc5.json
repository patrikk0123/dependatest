{"ast":null,"code":"var _jsxFileName = \"/home/pkorytar/Projects/RedHat/pnc-web-ui-react/src/components/Sorting/Sorting.tsx\";\nimport { Button, InputGroup, Select, SelectOption, SelectVariant } from '@patternfly/react-core';\nimport { SortAmountDownAltIcon, SortAmountDownIcon } from '@patternfly/react-icons';\nimport { useCallback, useEffect, useState } from 'react';\nimport { useLocation, useNavigate } from 'react-router-dom';\nimport { getComponentQueryParamValue, updateQueryParamsInURL } from '../../utils/queryParamsHelper';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport let SORT_ORDER;\n\n(function (SORT_ORDER) {\n  SORT_ORDER[\"Asc\"] = \"asc\";\n  SORT_ORDER[\"Desc\"] = \"desc\";\n})(SORT_ORDER || (SORT_ORDER = {}));\n\nexport const Sorting = _ref => {\n  var _Object$entries$filte;\n\n  let {\n    sortOptions,\n    componentId\n  } = _ref;\n  const location = useLocation();\n  const navigate = useNavigate();\n  const [isFirstRender, setIsFirstRender] = useState(true);\n  const defaultAttributeKey = (_Object$entries$filte = Object.entries(sortOptions).filter(_ref2 => {\n    let [k, v] = _ref2;\n    return v.defaultSorted;\n  })[0]) === null || _Object$entries$filte === void 0 ? void 0 : _Object$entries$filte[0];\n  const defaultSortingOrder = sortOptions[defaultAttributeKey].defaultSortedOrder || SORT_ORDER.Asc; // attribute by which list is sorted\n\n  const [sortAttribute, setSortAttribute] = useState(); //\n\n  const [sortOrder, setSortOrder] = useState(SORT_ORDER.Asc);\n  const [isSortSelectOpen, setIsSortSelectOpen] = useState(false);\n  const [isSorting, setIsSorting] = useState(false);\n  /**\n   * Add sort param by updating URL.\n   */\n\n  const addSortFilter = useCallback(function (filterAttribute, order) {\n    let replace = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n    updateQueryParamsInURL({\n      sort: `=${order}=${filterAttribute}`,\n      pageIndex: 1\n    }, componentId, location, navigate, replace);\n  }, [componentId, location, navigate]);\n  /**\n   * Delete sort param from URL.\n   */\n\n  const deleteSortFilter = () => {\n    updateQueryParamsInURL({\n      sort: '',\n      pageIndex: 1\n    }, componentId, location, navigate);\n  };\n  /**\n   * Sychronize UI with the URL sort param.\n   */\n\n\n  useEffect(() => {\n    const currentSortParam = getComponentQueryParamValue(location.search, 'sort', componentId) || '';\n\n    if (currentSortParam) {\n      var _currentSortParam$spl, _currentSortParam$spl2;\n\n      const sortOrderUrl = (_currentSortParam$spl = currentSortParam.split('=')) === null || _currentSortParam$spl === void 0 ? void 0 : _currentSortParam$spl[1];\n      const sortParam = (_currentSortParam$spl2 = currentSortParam.split('=')) === null || _currentSortParam$spl2 === void 0 ? void 0 : _currentSortParam$spl2[2];\n      setSortOrder(sortOrderUrl);\n      setSortAttribute(sortOptions[sortParam]);\n      setIsSorting(true);\n    } else {\n      setIsSorting(false);\n      setSortAttribute(undefined);\n    }\n  }, [location.search, location, componentId, navigate, sortOptions, defaultAttributeKey, addSortFilter]);\n  /**\n   * Add default sorting (if any) and check sortOptiions validity.\n   */\n\n  useEffect(() => {\n    const currentSortParam = getComponentQueryParamValue(location.search, 'sort', componentId) || '';\n\n    if (!currentSortParam && isFirstRender && defaultAttributeKey) {\n      addSortFilter(defaultAttributeKey, defaultSortingOrder, true);\n    }\n\n    if (isFirstRender) {\n      setIsFirstRender(false);\n    } else {\n      Object.entries(sortOptions).forEach(_ref3 => {\n        let [k, v] = _ref3;\n\n        // check sort options validity\n        if (k !== v.id) {\n          console.error('sortOptions: ', sortOptions);\n          throw new Error(`sortOptions have invalid format, object key (${k}) has to match id field (${v.id})!`);\n        }\n      });\n    }\n  }, [isFirstRender, defaultAttributeKey, defaultSortingOrder, addSortFilter, componentId, location, sortOptions]);\n  return /*#__PURE__*/_jsxDEV(InputGroup, {\n    children: [/*#__PURE__*/_jsxDEV(Select, {\n      hasPlaceholderStyle: true,\n      placeholderText: \"Sort\",\n      variant: SelectVariant.single,\n      onToggle: isOpen => {\n        setIsSortSelectOpen(isOpen);\n      },\n      onSelect: (_, selection) => {\n        setIsSortSelectOpen(false);\n        addSortFilter(selection === null || selection === void 0 ? void 0 : selection.id, sortOrder);\n      },\n      selections: sortAttribute,\n      isOpen: isSortSelectOpen,\n      children: [...Object.keys(sortOptions).map(filterAttributeKey => {\n        const filterAttribute = sortOptions[filterAttributeKey]; // use 'title' attribute as default\n\n        filterAttribute.toString = () => {\n          return filterAttribute.title;\n        };\n\n        return /*#__PURE__*/_jsxDEV(SelectOption, {\n          value: filterAttribute\n        }, filterAttribute.id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 141,\n          columnNumber: 20\n        }, this);\n      })]\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Button, {\n      onClick: () => {\n        addSortFilter(sortAttribute.id, SORT_ORDER.Asc ? SORT_ORDER.Desc : SORT_ORDER.Asc);\n      },\n      variant: \"plain\",\n      isDisabled: !isSorting,\n      icon: sortOrder === SORT_ORDER.Asc ? /*#__PURE__*/_jsxDEV(SortAmountDownAltIcon, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 152,\n        columnNumber: 46\n      }, this) : /*#__PURE__*/_jsxDEV(SortAmountDownIcon, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 152,\n        columnNumber: 74\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 7\n    }, this), isSorting && /*#__PURE__*/_jsxDEV(Button, {\n      style: {\n        padding: '1px'\n      },\n      onClick: () => {\n        deleteSortFilter();\n      },\n      variant: \"plain\",\n      isInline: true,\n      children: \"Remove sorting\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 118,\n    columnNumber: 5\n  }, this);\n};","map":{"version":3,"names":["Button","InputGroup","Select","SelectOption","SelectVariant","SortAmountDownAltIcon","SortAmountDownIcon","useCallback","useEffect","useState","useLocation","useNavigate","getComponentQueryParamValue","updateQueryParamsInURL","SORT_ORDER","Sorting","sortOptions","componentId","location","navigate","isFirstRender","setIsFirstRender","defaultAttributeKey","Object","entries","filter","k","v","defaultSorted","defaultSortingOrder","defaultSortedOrder","Asc","sortAttribute","setSortAttribute","sortOrder","setSortOrder","isSortSelectOpen","setIsSortSelectOpen","isSorting","setIsSorting","addSortFilter","filterAttribute","order","replace","sort","pageIndex","deleteSortFilter","currentSortParam","search","sortOrderUrl","split","sortParam","undefined","forEach","id","console","error","Error","single","isOpen","_","selection","keys","map","filterAttributeKey","toString","title","Desc","padding"],"sources":["/home/pkorytar/Projects/RedHat/pnc-web-ui-react/src/components/Sorting/Sorting.tsx"],"sourcesContent":["import { Button, InputGroup, Select, SelectOption, SelectVariant } from '@patternfly/react-core';\nimport { SortAmountDownAltIcon, SortAmountDownIcon } from '@patternfly/react-icons';\nimport { useCallback, useEffect, useState } from 'react';\nimport { useLocation, useNavigate } from 'react-router-dom';\n\nimport { getComponentQueryParamValue, updateQueryParamsInURL } from '../../utils/queryParamsHelper';\n\nexport enum SORT_ORDER {\n  Asc = 'asc',\n  Desc = 'desc',\n}\n\nexport interface ISortAttribute {\n  /**\n   * ID has to match object key {@link ISortOptions}, there is automatic checker throwing errors if they don't match.\n   */\n  id: string;\n  /**\n   * Sorting option title.\n   */\n  title: string;\n  /**\n   * Should be defaulted sorted by this option?\n   * Only one attribute should be dafault.\n   */\n  defaultSorted?: boolean;\n  /**\n   * Order by which defaulte attribute is sorted by default.\n   */\n  defaultSortedOrder?: SORT_ORDER;\n}\n\nexport interface ISortOptions {\n  [key: string]: ISortAttribute;\n}\n\ninterface ISortingProps {\n  sortOptions: ISortOptions;\n  componentId: any;\n}\n\nexport const Sorting = ({ sortOptions, componentId }: ISortingProps) => {\n  const location = useLocation();\n  const navigate = useNavigate();\n\n  const [isFirstRender, setIsFirstRender] = useState<boolean>(true);\n\n  const defaultAttributeKey = Object.entries(sortOptions).filter(([k, v]) => v.defaultSorted)[0]?.[0];\n  const defaultSortingOrder = sortOptions[defaultAttributeKey].defaultSortedOrder || SORT_ORDER.Asc;\n\n  // attribute by which list is sorted\n  const [sortAttribute, setSortAttribute] = useState<ISortAttribute | undefined>();\n  //\n  const [sortOrder, setSortOrder] = useState<SORT_ORDER>(SORT_ORDER.Asc);\n  const [isSortSelectOpen, setIsSortSelectOpen] = useState<boolean>(false);\n\n  const [isSorting, setIsSorting] = useState<boolean>(false);\n\n  /**\n   * Add sort param by updating URL.\n   */\n  const addSortFilter = useCallback(\n    (filterAttribute: string, order: SORT_ORDER, replace: boolean = false) => {\n      updateQueryParamsInURL({ sort: `=${order}=${filterAttribute}`, pageIndex: 1 }, componentId, location, navigate, replace);\n    },\n    [componentId, location, navigate]\n  );\n\n  /**\n   * Delete sort param from URL.\n   */\n  const deleteSortFilter = () => {\n    updateQueryParamsInURL({ sort: '', pageIndex: 1 }, componentId, location, navigate);\n  };\n\n  /**\n   * Sychronize UI with the URL sort param.\n   */\n  useEffect(() => {\n    const currentSortParam = getComponentQueryParamValue(location.search, 'sort', componentId) || '';\n\n    if (currentSortParam) {\n      const sortOrderUrl = currentSortParam.split('=')?.[1];\n      const sortParam = currentSortParam.split('=')?.[2];\n\n      setSortOrder(sortOrderUrl as SORT_ORDER);\n      setSortAttribute(sortOptions[sortParam]);\n      setIsSorting(true);\n    } else {\n      setIsSorting(false);\n      setSortAttribute(undefined);\n    }\n  }, [location.search, location, componentId, navigate, sortOptions, defaultAttributeKey, addSortFilter]);\n\n  /**\n   * Add default sorting (if any) and check sortOptiions validity.\n   */\n  useEffect(() => {\n    const currentSortParam = getComponentQueryParamValue(location.search, 'sort', componentId) || '';\n    if (!currentSortParam && isFirstRender && defaultAttributeKey) {\n      addSortFilter(defaultAttributeKey, defaultSortingOrder, true);\n    }\n\n    if (isFirstRender) {\n      setIsFirstRender(false);\n    } else {\n      Object.entries(sortOptions).forEach(([k, v]) => {\n        // check sort options validity\n        if (k !== v.id) {\n          console.error('sortOptions: ', sortOptions);\n          throw new Error(`sortOptions have invalid format, object key (${k}) has to match id field (${v.id})!`);\n        }\n      });\n    }\n  }, [isFirstRender, defaultAttributeKey, defaultSortingOrder, addSortFilter, componentId, location, sortOptions]);\n\n  return (\n    <InputGroup>\n      <Select\n        hasPlaceholderStyle\n        placeholderText=\"Sort\"\n        variant={SelectVariant.single}\n        onToggle={(isOpen) => {\n          setIsSortSelectOpen(isOpen);\n        }}\n        onSelect={(_, selection) => {\n          setIsSortSelectOpen(false);\n          addSortFilter((selection as ISortAttribute)?.id, sortOrder);\n        }}\n        selections={sortAttribute}\n        isOpen={isSortSelectOpen}\n      >\n        {[\n          ...Object.keys(sortOptions).map((filterAttributeKey: string) => {\n            const filterAttribute = sortOptions[filterAttributeKey];\n            // use 'title' attribute as default\n            filterAttribute.toString = () => {\n              return filterAttribute.title;\n            };\n\n            return <SelectOption key={filterAttribute.id} value={filterAttribute} />;\n          }),\n        ]}\n      </Select>\n\n      <Button\n        onClick={() => {\n          addSortFilter(sortAttribute!.id, SORT_ORDER.Asc ? SORT_ORDER.Desc : SORT_ORDER.Asc);\n        }}\n        variant=\"plain\"\n        isDisabled={!isSorting}\n        icon={sortOrder === SORT_ORDER.Asc ? <SortAmountDownAltIcon /> : <SortAmountDownIcon />}\n      ></Button>\n\n      {isSorting && (\n        <Button\n          style={{ padding: '1px' }}\n          onClick={() => {\n            deleteSortFilter();\n          }}\n          variant=\"plain\"\n          isInline\n        >\n          Remove sorting\n        </Button>\n      )}\n    </InputGroup>\n  );\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}