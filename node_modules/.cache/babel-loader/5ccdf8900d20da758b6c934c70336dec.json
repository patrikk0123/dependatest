{"ast":null,"code":"import axios from 'axios';\nimport * as WebConfigAPI from './WebConfigService';\nimport { keycloakService } from './keycloakService';\n/**\n * Utils class managing http client instance, only one instance is created.\n */\n\nclass PncClient {\n  // development and testing purposes\n  constructor() {\n    this.httpClient = void 0;\n    this.mathRandom = Math.random();\n\n    this.createHttpClient = () => {\n      const httpClient = axios.create({\n        baseURL: WebConfigAPI.getPncUrl()\n      });\n      httpClient.interceptors.request.use(config => {\n        var _config$params;\n\n        // perform actions before request is sent\n        console.log(config);\n\n        if (keycloakService.isKeycloakAvailable && keycloakService.isAuthenticated()) {\n          var _config$headers;\n\n          config.headers = (_config$headers = config.headers) !== null && _config$headers !== void 0 ? _config$headers : {};\n          config.headers.Authorization = `Bearer ` + keycloakService.getToken();\n        }\n        /*\n         * Convert pageIndex to zero based to be compatible with Orch API\n         *  - Orch API first page index value is 0\n         *  - UI first page index value is 1\n         */\n\n\n        if ((_config$params = config.params) !== null && _config$params !== void 0 && _config$params.pageIndex) {\n          const pageIndex = config.params.pageIndex;\n\n          if (Number.isInteger(+pageIndex)) {\n            config.params.pageIndex = Number(pageIndex) - 1;\n          } else {\n            throw new Error(`Invalid pageIndex: ${pageIndex}, canceling HTTP request`);\n          }\n        }\n\n        return config;\n      });\n      return httpClient;\n    };\n\n    this.httpClient = this.createHttpClient();\n  }\n  /**\n   * Creates Axios instance and configure interceptors.\n   *\n   * @returns Axios instance\n   */\n\n\n  // PUBLIC\n\n  /**\n   * @returns Axios instance\n   */\n  getHttpClient() {\n    return this.httpClient;\n  }\n\n}\n\nexport const pncClient = new PncClient();","map":{"version":3,"names":["axios","WebConfigAPI","keycloakService","PncClient","constructor","httpClient","mathRandom","Math","random","createHttpClient","create","baseURL","getPncUrl","interceptors","request","use","config","console","log","isKeycloakAvailable","isAuthenticated","headers","Authorization","getToken","params","pageIndex","Number","isInteger","Error","getHttpClient","pncClient"],"sources":["/home/pkorytar/Projects/RedHat/pnc-web-ui-react/src/services/pncClient.ts"],"sourcesContent":["import axios, { AxiosInstance } from 'axios';\n\nimport * as WebConfigAPI from './WebConfigService';\nimport { keycloakService } from './keycloakService';\n\n/**\n * Utils class managing http client instance, only one instance is created.\n */\nclass PncClient {\n  private httpClient: AxiosInstance;\n  public mathRandom: number = Math.random(); // development and testing purposes\n\n  constructor() {\n    this.httpClient = this.createHttpClient();\n  }\n\n  /**\n   * Creates Axios instance and configure interceptors.\n   *\n   * @returns Axios instance\n   */\n  private createHttpClient = (): AxiosInstance => {\n    const httpClient = axios.create({\n      baseURL: WebConfigAPI.getPncUrl(),\n    });\n\n    httpClient.interceptors.request.use((config) => {\n      // perform actions before request is sent\n      console.log(config);\n\n      if (keycloakService.isKeycloakAvailable && keycloakService.isAuthenticated()) {\n        config.headers = config.headers ?? {};\n        config.headers.Authorization = `Bearer ` + keycloakService.getToken();\n      }\n\n      /*\n       * Convert pageIndex to zero based to be compatible with Orch API\n       *  - Orch API first page index value is 0\n       *  - UI first page index value is 1\n       */\n      if (config.params?.pageIndex) {\n        const pageIndex = config.params.pageIndex;\n        if (Number.isInteger(+pageIndex)) {\n          config.params.pageIndex = Number(pageIndex) - 1;\n        } else {\n          throw new Error(`Invalid pageIndex: ${pageIndex}, canceling HTTP request`);\n        }\n      }\n\n      return config;\n    });\n    return httpClient;\n  };\n\n  // PUBLIC\n\n  /**\n   * @returns Axios instance\n   */\n  public getHttpClient(): AxiosInstance {\n    return this.httpClient;\n  }\n}\n\nexport const pncClient = new PncClient();\n"],"mappings":"AAAA,OAAOA,KAAP,MAAqC,OAArC;AAEA,OAAO,KAAKC,YAAZ,MAA8B,oBAA9B;AACA,SAASC,eAAT,QAAgC,mBAAhC;AAEA;AACA;AACA;;AACA,MAAMC,SAAN,CAAgB;EAE6B;EAE3CC,WAAW,GAAG;IAAA,KAHNC,UAGM;IAAA,KAFPC,UAEO,GAFcC,IAAI,CAACC,MAAL,EAEd;;IAAA,KASNC,gBATM,GASa,MAAqB;MAC9C,MAAMJ,UAAU,GAAGL,KAAK,CAACU,MAAN,CAAa;QAC9BC,OAAO,EAAEV,YAAY,CAACW,SAAb;MADqB,CAAb,CAAnB;MAIAP,UAAU,CAACQ,YAAX,CAAwBC,OAAxB,CAAgCC,GAAhC,CAAqCC,MAAD,IAAY;QAAA;;QAC9C;QACAC,OAAO,CAACC,GAAR,CAAYF,MAAZ;;QAEA,IAAId,eAAe,CAACiB,mBAAhB,IAAuCjB,eAAe,CAACkB,eAAhB,EAA3C,EAA8E;UAAA;;UAC5EJ,MAAM,CAACK,OAAP,sBAAiBL,MAAM,CAACK,OAAxB,6DAAmC,EAAnC;UACAL,MAAM,CAACK,OAAP,CAAeC,aAAf,GAAgC,SAAD,GAAYpB,eAAe,CAACqB,QAAhB,EAA3C;QACD;QAED;AACN;AACA;AACA;AACA;;;QACM,sBAAIP,MAAM,CAACQ,MAAX,2CAAI,eAAeC,SAAnB,EAA8B;UAC5B,MAAMA,SAAS,GAAGT,MAAM,CAACQ,MAAP,CAAcC,SAAhC;;UACA,IAAIC,MAAM,CAACC,SAAP,CAAiB,CAACF,SAAlB,CAAJ,EAAkC;YAChCT,MAAM,CAACQ,MAAP,CAAcC,SAAd,GAA0BC,MAAM,CAACD,SAAD,CAAN,GAAoB,CAA9C;UACD,CAFD,MAEO;YACL,MAAM,IAAIG,KAAJ,CAAW,sBAAqBH,SAAU,0BAA1C,CAAN;UACD;QACF;;QAED,OAAOT,MAAP;MACD,CAxBD;MAyBA,OAAOX,UAAP;IACD,CAxCa;;IACZ,KAAKA,UAAL,GAAkB,KAAKI,gBAAL,EAAlB;EACD;EAED;AACF;AACA;AACA;AACA;;;EAkCE;;EAEA;AACF;AACA;EACSoB,aAAa,GAAkB;IACpC,OAAO,KAAKxB,UAAZ;EACD;;AArDa;;AAwDhB,OAAO,MAAMyB,SAAS,GAAG,IAAI3B,SAAJ,EAAlB"},"metadata":{},"sourceType":"module"}